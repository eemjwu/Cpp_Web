# 不足与改进
1. 防止攻击
   1. 防御性编程，权限管理，防止离职的管理员恶意删除资源
   2. sql注入
        >   SQL注入就是一种通过操作输入来修改后台SQL语句达到代码执行进行攻击目的的技术。  
        > 攻击者会将一些恶意代码插入到字符串中。然后会通过各种手段将该字符串传递到SQLServer数据库的实例中进行分析和执行。只要这个恶意代码符合SQL语句的规则，则在代码编译与执行的时候，就不会被系统所发现。,实现无帐号登录，甚至篡改数据库。  
        >  解决：  
        在用户名登陆时，使用正则表达式过滤传入的参数特殊字符，如"-"(用于注释掉后面的输入)，“or”，“>”,
   3. 防xss攻击处理
        >    XSS攻击即跨站脚本攻击(Cross Site Scripting) 它允许恶意web用户将代码植入到提供给其它用户使用的页面中。   
        > XXS防御措施：  
        >     a、  可以做Filter过滤器过滤特殊字符。同时需要对HTML转义处理。将其中的”<”,”>”等特殊字符进行转义编码  
        >     b、  不要在页面中插入任何不可信数据。  
        >     c、  在将不可信数据插入到HTML标签之间时，对这些数据进行HTML Entity编码。  
        >     d、  在将不可信数据插入到HTML属性里时，对这些数据进行HTML属性编码。  
        >     e、  在将不可信数据插入到SCRIPT里时，对这些数据进行SCRIPT编码。  
        >     f、   在将不可信数据插入到Style属性里时，对这些数据进行CSS编码。  
        >     g、  在将不可信数据插入到HTML URL里时，对这些数据进行URL编码。  
        >     h、  使用富文本时，使用XSS规则引擎进行编码过滤。  
2. 系统容灾
   - 主副服务器，当一台故障时，立刻启动副服务器
   - 问题：主副服务器同步问题
   - 实现session共享。一般有几个解决办法：
   [nginx 负载均衡session共享](https://segmentfault.com/a/1190000004708640)
      - iphash,把特定ip发送给特定主机，就不存在session这个问题了，因为1个用户对应1台主机。但是某时刻当来自某个IP地址的请求特别多，那么将导致某台负载服务器的压力可能非常大，而其他负载服务器却空闲的不均衡情况，这就违背了我们负载均衡的初衷。
      - 搭建redis集群或者memcached集群，用集群自带的同步方法来帮我们在不同的主机中同步session，这样就相当于把原来的一份session变成了N分session（有点浪费，哈哈），session的同步就依赖于NoSql集群的同步了。
      - 不使用session，换作cookie。但是秉承着防御性编程的原则，我们不能相信用户输入，因为cookie可能被禁用，甚至篡改。
      - 单独设置一个session服务器，负载服务器得到一个sessionid过后，去session服务器获得会话状态，然后根据状态来响应用户请求，如果会话状态为空，则在session服务器中设置一个会话状态，然后返回给用户一个sessionid。  
3. 高并发下分布式部署
   - 使用nginx upstream 模块，对请求进行负载均衡配置
   - 具体如下：  
   https://blog.csdn.net/u011630575/article/details/48184227